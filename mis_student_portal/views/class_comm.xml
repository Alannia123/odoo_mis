<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="portal_all_class_comms" name="My Sales Orders">
        <t t-call="portal.portal_layout">
            <t t-set="breadcrumbs_searchbar" t-value="True"/>
            <t t-call="portal.portal_searchbar">
                <t t-set="title">Class Communications</t>
            </t>
            <div class="container glow-background">
            <h5>Today Communications</h5>
            <div t-if="not today_class_comms" class="alert alert-warning" role="alert" style="font-size: 10 pt">
                No Communications for Today.
            </div>
            <t t-if="today_class_comms">
                <table class="table table-sm table-striped table-responsive">
                    <thead>
                        <tr>
                            <th>Title #</th>
                            <th class="text-center">Date</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-foreach="today_class_comms" t-as="comms">
                            <tr>
                                <td><a t-attf-href="/class_comm/get_comm/#{comms.id}" ><t t-out="comms.name"/></a></td>
                                <td t-esc="comms.create_date"/>
                            </tr>
                        </t>
                    </tbody>
                </table>
            </t>

            <h5>All Class Communications</h5>
            <div t-if="not class_comms" class="alert alert-warning" role="alert">
                No more Communications for You.
            </div>
            <t t-if="class_comms">
                <table class="table table-sm table-striped table-responsive">
                    <thead>
                        <tr >
                            <th>
                                <span >Title #</span>
                            </th>
                            <th class="text-center">Date</th>
                        </tr>
                    </thead>
                    <t t-foreach="class_comms" t-as="comms">
                        <tr>
                            <td><a t-attf-href="/class_comm/get_comm/#{comms.id}" ><t t-out="comms.name"/></a></td>
                            <td class="text-end">
                                <span t-field="comms.create_date" />
                            </td>
                        </tr>
                    </t>
                </table>
            </t>
            </div>
        </t>
    </template>

    <template id="portal_open_communication" name="My Sales Orders">
        <t t-call="portal.portal_layout">
            <t t-set="breadcrumbs_searchbar" t-value="True"/>
            <t t-call="portal.portal_searchbar">
                <t t-set="title">Communications</t>
            </t>
            <a t-attf-href="/school/class_communation" ><h5 style="color:blue;">Communications</h5></a>
            <div >
                <span><b>Title :</b></span><span t-field="class_com_id.name"></span><br></br>
                <span><b>Faculty :</b></span><span t-field="class_com_id.class_div_id.faculty_id.name"></span>
            </div>
                <table class="table table-sm table-striped table-responsive">
                    <thead>
                        <tr>
                            <th>Subject</th>
                            <th class="text-center">Homework Desc</th>
                            <th class="text-center">File</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-foreach="home_work_id.work_line_ids" t-as="line">
                            <tr>
                                <td><span t-field="line.subject_id.name"/></td>
                                <td ><span t-field="line.homework"/></td>
                                <td >
                                    <a t-att-href="'/web/content/%s?download=true' % line.attachment_id.id" ><i class="fa fa-download"/> </a>
                                </td>
                            </tr>
                        </t>
                    </tbody>
                </table>
            <!-- Chatter Section -->
            <div id="portal_chatter">
                <h3>Comments</h3>
                <t t-if="home_work_id.message_ids">
                    <ul class="list-group">
                        <t t-foreach="home_work_id.message_ids" t-as="message">
                            <li class="list-group-item">
                                <strong><t t-esc="message.author_id.name"/></strong>:
                                <t t-esc="message.body"/>
                                <br/>
                                <small><t t-esc="message.date"/></small>
                            </li>
                        </t>
                    </ul>
                </t>
                <form action="/student/add_comment" method="POST"  enctype="multipart/form-data">
                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
<!--                <form action="/student/add_comment" method="post">-->
<!--                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>-->
                    <input type="hidden" name="res_id" t-att-value="home_work_id.id"/>
                    <input type="hidden" name="model" value="student.homework"/>
                    <textarea name="message" class="form-control" required="1" placeholder="Add a comment..."></textarea>
                    <button type="submit" class="btn btn-success mt-2">
                        <i class="fa fa-comment"></i> Post Comment
                    </button>
                </form>
            </div>
<!--            <div id="invoice_communication" class="mt-4">-->
<!--                        <h3>Communication history</h3>-->
<!--                        <t t-call="portal.message_thread"/>-->
<!--                    </div>-->
<!--            <t t-call="mail.portal_chatter">-->
<!--                <t t-set="res_model" t-value="'student.homework'" />-->
<!--                <t t-set="res_id" t-value="home_work_id.id" />-->
<!--            </t>-->
            </t>


    </template>

</odoo>